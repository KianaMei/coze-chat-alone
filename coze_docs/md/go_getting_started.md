https://www.coze.cn/open/docs/developer_guides/go_getting_started

# 扣子
创建
[主页](https://www.coze.cn/sign)[项目开发](https://www.coze.cn/sign)[资源库](https://www.coze.cn/sign)[任务中心](https://www.coze.cn/sign)[效果评测](https://www.coze.cn/sign)[空间配置](https://www.coze.cn/sign)
[模板商店](https://www.coze.cn/sign)[插件商店](https://www.coze.cn/sign)[作品社区](https://www.coze.cn/sign)[API 管理](https://www.coze.cn/open/playground)[文档中心](https://www.coze.cn/open/docs/guides)
目录取消固定
[使用指南](https://www.coze.cn/open/docs/guides)
[开发指南](https://www.coze.cn/open/docs/dev_how_to_guides)
[API 和 SDK](https://www.coze.cn/open/docs/developer_guides)
API 参考
[API 介绍](https://www.coze.cn/open/docs/developer_guides/coze_api_overview)[更新日志](https://www.coze.cn/open/docs/developer_guides/changelog)[准备工作](https://www.coze.cn/open/docs/developer_guides/preparation)[API Playground](https://www.coze.cn/open/docs/developer_guides/api_playground)
鉴权
[鉴权方式概述](https://www.coze.cn/open/docs/developer_guides/authentication)[添加个人访问令牌](https://www.coze.cn/open/docs/developer_guides/pat)[添加服务访问令牌](https://www.coze.cn/open/docs/developer_guides/service_token)[OAuth 应用管理](https://www.coze.cn/open/docs/developer_guides/oauth_apps)[通过示例文件体验 OAuth 授权流程](https://www.coze.cn/open/docs/developer_guides/ouath_demo)[OAuth 授权码授权](https://www.coze.cn/open/docs/developer_guides/oauth_code)[OAuth PKCE](https://www.coze.cn/open/docs/developer_guides/oauth_pkce)[OAuth 设备授权](https://www.coze.cn/open/docs/developer_guides/oauth_device_code)[OAuth JWT 授权（开发者）](https://www.coze.cn/open/docs/developer_guides/oauth_jwt)[OAuth JWT 授权（渠道场景）](https://www.coze.cn/open/docs/developer_guides/oauth_jwt_channel)[OAuth JWT 授权（跨账号授权场景）](https://www.coze.cn/open/docs/developer_guides/oauth_jwt_collaborate)[OAuth JWT 授权（企业特权应用）](https://www.coze.cn/open/docs/developer_guides/oauth_jwt_privilege)[OAuth 授权（多人协作场景）](https://www.coze.cn/open/docs/developer_guides/oauth_collaborate)[鉴权常见问题](https://www.coze.cn/open/docs/developer_guides/authentication_faq)
智能体和应用
[创建智能体](https://www.coze.cn/open/docs/developer_guides/create_bot)[更新智能体](https://www.coze.cn/open/docs/developer_guides/update_bot)[发布智能体](https://www.coze.cn/open/docs/developer_guides/publish_bot)[查看智能体列表](https://www.coze.cn/open/docs/developer_guides/bots_list_draft_published)[查看智能体配置](https://www.coze.cn/open/docs/developer_guides/get_metadata_draft_published)[开启或关闭智能体多人协作](https://www.coze.cn/open/docs/developer_guides/switch_bot_develop_mode)[添加智能体的协作者](https://www.coze.cn/open/docs/developer_guides/add_bot_collaborator)[添加应用的协作者](https://www.coze.cn/open/docs/developer_guides/add_app_collaborator)[删除智能体的协作者](https://www.coze.cn/open/docs/developer_guides/remove_bot_collaborator)[删除应用的协作者](https://www.coze.cn/open/docs/developer_guides/remove_app_collaborator)[查看智能体版本列表](https://www.coze.cn/open/docs/developer_guides/list_bot_versions)[复制资源](https://www.coze.cn/open/docs/developer_guides/copy_resource_task)[查询资源复制的结果](https://www.coze.cn/open/docs/developer_guides/query_resource_copy_execution_result)[下架智能体](https://www.coze.cn/open/docs/developer_guides/unpublish_agent)[Bot object](https://www.coze.cn/open/docs/developer_guides/bot_object)[查看应用列表](https://www.coze.cn/open/docs/developer_guides/published_apps_list)[智能体发布回调事件](https://www.coze.cn/open/docs/developer_guides/agent_callback_messages)[智能体删除回调事件](https://www.coze.cn/open/docs/developer_guides/agent_delete_callback_messages)[智能体下架回调事件](https://www.coze.cn/open/docs/developer_guides/agent_unpublished_callback_messages)
工作空间
[创建工作空间](https://www.coze.cn/open/docs/developer_guides/create_workspace)[查看空间列表](https://www.coze.cn/open/docs/developer_guides/list_workspace)[修改工作空间基本信息](https://www.coze.cn/open/docs/developer_guides/update_workspace_info)[查看空间成员列表](https://www.coze.cn/open/docs/developer_guides/list_space_member)[批量邀请用户加入空间](https://www.coze.cn/open/docs/developer_guides/add_space_member)[批量移除空间中的用户](https://www.coze.cn/open/docs/developer_guides/remove_space_member)
文件夹
[查询文件夹列表](https://www.coze.cn/open/docs/developer_guides/workspace_list_folder)[查询文件夹详情](https://www.coze.cn/open/docs/developer_guides/workspace_read_folder)
企业/组织
[成员管理（火山 API）](https://www.coze.cn/open/docs/developer_guides/create_coze_user)[添加团队/企业成员](https://www.coze.cn/open/docs/developer_guides/add_enterprise_member)[修改企业员工的角色](https://www.coze.cn/open/docs/developer_guides/update_enterprise_people)[移除团队/企业成员](https://www.coze.cn/open/docs/developer_guides/remove_enterprise_member)[创建组织](https://www.coze.cn/open/docs/developer_guides/create_organization)[修改组织基本信息](https://www.coze.cn/open/docs/developer_guides/update_organization_info)[查询组织列表](https://www.coze.cn/open/docs/developer_guides/list_organization)[添加组织成员](https://www.coze.cn/open/docs/developer_guides/add_organization_people)[查询组织成员列表](https://www.coze.cn/open/docs/developer_guides/list_organization_people)[修改组织成员角色](https://www.coze.cn/open/docs/developer_guides/update_organization_people)[移除组织成员](https://www.coze.cn/open/docs/developer_guides/remove_organization_member)
会话与消息
[创建会话](https://www.coze.cn/open/docs/developer_guides/create_conversation)[查看会话信息](https://www.coze.cn/open/docs/developer_guides/retrieve_conversation)[查看会话列表](https://www.coze.cn/open/docs/developer_guides/list_conversations)[更新会话名称](https://www.coze.cn/open/docs/developer_guides/edit_conversation)[删除会话](https://www.coze.cn/open/docs/developer_guides/delete_conversation)[清除上下文](https://www.coze.cn/open/docs/developer_guides/clear_conversation_context)[创建消息](https://www.coze.cn/open/docs/developer_guides/create_message)[查看消息列表](https://www.coze.cn/open/docs/developer_guides/list_message)[查看消息详情](https://www.coze.cn/open/docs/developer_guides/retrieve_message)[修改消息](https://www.coze.cn/open/docs/developer_guides/modify_message)[删除消息](https://www.coze.cn/open/docs/developer_guides/delete_message)[消息 type 说明](https://www.coze.cn/open/docs/developer_guides/message_type)[提交消息评价](https://www.coze.cn/open/docs/developer_guides/message_feedback)[删除消息评价](https://www.coze.cn/open/docs/developer_guides/delete_message_feedback)
对话
[发起对话](https://www.coze.cn/open/docs/developer_guides/chat_v3)[查看对话详情](https://www.coze.cn/open/docs/developer_guides/retrieve_chat)[查看对话消息详情](https://www.coze.cn/open/docs/developer_guides/list_chat_messages)[提交工具执行结果](https://www.coze.cn/open/docs/developer_guides/chat_submit_tool_outputs)[取消进行中的对话](https://www.coze.cn/open/docs/developer_guides/chat_cancel)
工作流
[执行工作流](https://www.coze.cn/open/docs/developer_guides/workflow_run)[执行工作流（流式响应）](https://www.coze.cn/open/docs/developer_guides/workflow_stream_run)[恢复运行工作流（流式响应）](https://www.coze.cn/open/docs/developer_guides/workflow_resume)[恢复运行工作流](https://www.coze.cn/open/docs/developer_guides/resume_workflow)[查询工作流异步运行结果](https://www.coze.cn/open/docs/developer_guides/workflow_history)[执行对话流](https://www.coze.cn/open/docs/developer_guides/workflow_chat)[查询输出节点的执行结果](https://www.coze.cn/open/docs/developer_guides/get_node_execute_history_response)[查询工作流列表](https://www.coze.cn/open/docs/developer_guides/get_workflow_list)[查询工作流基本信息](https://www.coze.cn/open/docs/developer_guides/get_workflow_info)[查询工作流的版本列表](https://www.coze.cn/open/docs/developer_guides/list_workflow_version)[开启或关闭工作流多人协作](https://www.coze.cn/open/docs/developer_guides/switch_workflow_develop_mode)[添加工作流协作者](https://www.coze.cn/open/docs/developer_guides/add_workflow_collaborator)[删除工作流协作者](https://www.coze.cn/open/docs/developer_guides/remove_workflow_collaborator)
文件
[上传文件](https://www.coze.cn/open/docs/developer_guides/upload_files)[查看文件详情](https://www.coze.cn/open/docs/developer_guides/retrieve_files)
智能音视频
ASR、TTS 与音色
[查看音色列表](https://www.coze.cn/open/docs/developer_guides/list_voices)[语音合成](https://www.coze.cn/open/docs/developer_guides/text_to_speech)[语音识别](https://www.coze.cn/open/docs/developer_guides/audio_transcriptions)[复刻音色](https://www.coze.cn/open/docs/developer_guides/clone_voices)
RTC 语音
[创建房间](https://www.coze.cn/open/docs/developer_guides/create_room)[Realtime 上行事件](https://www.coze.cn/open/docs/developer_guides/signaling_uplink_event)[Realtime 下行事件](https://www.coze.cn/open/docs/developer_guides/signaling_downlink_event)[Realtime 事件错误码](https://www.coze.cn/open/docs/developer_guides/realtime_error_codes)
WebSocket 语音
[双向流式语音识别](https://www.coze.cn/open/docs/developer_guides/asr_api)[双向流式语音识别事件](https://www.coze.cn/open/docs/developer_guides/asr_event)[双向流式语音合成](https://www.coze.cn/open/docs/developer_guides/tts_api)[双向流式语音合成事件](https://www.coze.cn/open/docs/developer_guides/tts_event)[双向流式语音对话](https://www.coze.cn/open/docs/developer_guides/streaming_chat_api)[双向流式对话上行事件](https://www.coze.cn/open/docs/developer_guides/streaming_chat_event)[双向流式对话下行事件](https://www.coze.cn/open/docs/developer_guides/streaming_chat_downlink_event)
声纹识别
[创建声纹组](https://www.coze.cn/open/docs/developer_guides/create_voiceprint_group)[查询声纹组列表](https://www.coze.cn/open/docs/developer_guides/list_voiceprint_group)[更新声纹组信息](https://www.coze.cn/open/docs/developer_guides/update_voiceprint_group)[删除声纹组](https://www.coze.cn/open/docs/developer_guides/delete_voiceprint_group)[创建声纹](https://www.coze.cn/open/docs/developer_guides/create_voiceprint)[更新声纹](https://www.coze.cn/open/docs/developer_guides/update_voiceprint)[查询声纹列表](https://www.coze.cn/open/docs/developer_guides/list_voiceprint)[删除声纹](https://www.coze.cn/open/docs/developer_guides/delete_voiceprint)[声纹特征比对](https://www.coze.cn/open/docs/developer_guides/identify_voiceprint)
知识库
[创建知识库](https://www.coze.cn/open/docs/developer_guides/create_dataset)[查看知识库列表](https://www.coze.cn/open/docs/developer_guides/list_dataset)[修改知识库信息](https://www.coze.cn/open/docs/developer_guides/update_dataset)[删除知识库](https://www.coze.cn/open/docs/developer_guides/delete_dataset)[创建知识库文件](https://www.coze.cn/open/docs/developer_guides/create_knowledge_files)[修改知识库文件](https://www.coze.cn/open/docs/developer_guides/modify_knowledge_files)[查看知识库文件列表](https://www.coze.cn/open/docs/developer_guides/list_knowledge_files)[查看知识库文件上传进度](https://www.coze.cn/open/docs/developer_guides/get_dataset_progress)[更新知识库图片描述](https://www.coze.cn/open/docs/developer_guides/update_image_caption)[查看知识库图片列表](https://www.coze.cn/open/docs/developer_guides/get_images)[删除知识库文件](https://www.coze.cn/open/docs/developer_guides/delete_knowdge_files)
插件
[查询付费插件列表](https://www.coze.cn/open/docs/developer_guides/list_plugin)[查询插件分类](https://www.coze.cn/open/docs/developer_guides/list_plugin_category)[查询插件详情](https://www.coze.cn/open/docs/developer_guides/get_plugin)[批量查询插件信息](https://www.coze.cn/open/docs/developer_guides/batch_get_plugins_info)[调用插件工具](https://www.coze.cn/open/docs/developer_guides/call_plugin_tool)[申请插件扩容回调事件](https://www.coze.cn/open/docs/developer_guides/benefit_plugin_scale_requested)[插件扩容到期回调事件](https://www.coze.cn/open/docs/developer_guides/benefit_plugin_scale_expired)
变量
[设置用户变量的值](https://www.coze.cn/open/docs/developer_guides/update_variable)[获取用户变量的值](https://www.coze.cn/open/docs/developer_guides/read_variable)
渠道
[更新审核结果](https://www.coze.cn/open/docs/developer_guides/update_review_result)[添加发布平台](https://www.coze.cn/open/docs/developer_guides/install_channel)[绑定设备](https://www.coze.cn/open/docs/developer_guides/bind_connector_config)
终端用户配额管控
[创建终端用户权益额度](https://www.coze.cn/open/docs/developer_guides/create_device_quotas)[查询终端用户的权益配额](https://www.coze.cn/open/docs/developer_guides/get_device_quotas)[更新终端用户的权益额度](https://www.coze.cn/open/docs/developer_guides/update_device_quotas)
账单与权益
[导出终端用户账单](https://www.coze.cn/open/docs/developer_guides/create_bill_task)[查询账单文件](https://www.coze.cn/open/docs/developer_guides/billing_file)[查询套餐权益](https://www.coze.cn/open/docs/developer_guides/get_benefit)[账单推送回调事件](https://www.coze.cn/open/docs/developer_guides/billing_callback_message)
回调
[创建回调应用](https://www.coze.cn/open/docs/developer_guides/create_callback_app)[修改回调应用](https://www.coze.cn/open/docs/developer_guides/update_callback_app)[查询回调应用列表](https://www.coze.cn/open/docs/developer_guides/list_callback_app)[删除回调应用](https://www.coze.cn/open/docs/developer_guides/delete_callback_app)[订阅回调事件](https://www.coze.cn/open/docs/developer_guides/subscribe_callback_message)[查询已订阅的事件](https://www.coze.cn/open/docs/developer_guides/list_subscribed_callback_message)[取消订阅事件](https://www.coze.cn/open/docs/developer_guides/unsubscribe_callback_message)
历史版本接口
[【Deprecated】查看已发布智能体列表](https://www.coze.cn/open/docs/developer_guides/published_bots_list)[【Deprecated】获取已发布智能体的配置](https://www.coze.cn/open/docs/developer_guides/get_metadata)
[错误码](https://www.coze.cn/open/docs/developer_guides/coze_error_codes)[API 常见问题](https://www.coze.cn/open/docs/developer_guides/api_faq)[模型能力差异](https://www.coze.cn/open/docs/developer_guides/model_api_param_support)
最佳实践
[通过对话接口获取智能体回复](https://www.coze.cn/open/docs/developer_guides/get_chat_response)[错误码 4100/4101 问题排查](https://www.coze.cn/open/docs/developer_guides/troubleshooting_4100_4101)[如何实现会话隔离](https://www.coze.cn/open/docs/developer_guides/session_isolation)[升级企业/团队版后更新 API 授权](https://www.coze.cn/open/docs/developer_guides/update_authorization)
SDK 参考
Chat SDK
[Chat SDK 概述](https://www.coze.cn/open/docs/developer_guides/web_sdk_overview)[安装并使用 Chat SDK](https://www.coze.cn/open/docs/developer_guides/install_web_sdk)[Chat SDK 发布历史](https://www.coze.cn/open/docs/developer_guides/web_sdk_changelog)[（历史版本）Chat SDK](https://www.coze.cn/open/docs/developer_guides/web_sdk)[Chat SDK 常见问题](https://www.coze.cn/open/docs/developer_guides/chat_sdk_faq)
Python SDK
[Python SDK 概述](https://www.coze.cn/open/docs/developer_guides/python_overview)[安装 Python SDK](https://www.coze.cn/open/docs/developer_guides/python_installation)[配置访问密钥](https://www.coze.cn/open/docs/developer_guides/python_access_token)[快速开始](https://www.coze.cn/open/docs/developer_guides/python_getting_started)
Node.js SDK
[Node.js SDK 概述](https://www.coze.cn/open/docs/developer_guides/nodejs_overview)[安装 Node.js SDK](https://www.coze.cn/open/docs/developer_guides/nodejs_install)[配置访问密钥](https://www.coze.cn/open/docs/developer_guides/nodejs_access_token)[快速开始](https://www.coze.cn/open/docs/developer_guides/nodejs_getting_started)
Java SDK
[Java SDK 概述](https://www.coze.cn/open/docs/developer_guides/java_overview)[安装 Java SDK](https://www.coze.cn/open/docs/developer_guides/java_installation)[配置访问密钥](https://www.coze.cn/open/docs/developer_guides/java_access_token)[快速开始](https://www.coze.cn/open/docs/developer_guides/java_getting_started)
Go SDK
[Go SDK 概述](https://www.coze.cn/open/docs/developer_guides/go_overview)[安装 Go SDK](https://www.coze.cn/open/docs/developer_guides/go_installation)[配置访问密钥](https://www.coze.cn/open/docs/developer_guides/go_access_token)[快速开始](https://www.coze.cn/open/docs/developer_guides/go_getting_started)
Web SDK
[安装并使用 Web SDK](https://www.coze.cn/open/docs/developer_guides/ui_builder_web_sdk)
Card SDK
[安装并使用 Card SDK](https://www.coze.cn/open/docs/developer_guides/card_sdk)
[实践教程](https://www.coze.cn/open/docs/tutorial)
[扣子空间](https://www.coze.cn/open/docs/cozespace)
[扣子罗盘](https://www.coze.cn/open/docs/cozeloop)
[客户案例](https://www.coze.cn/open/docs/customers)
[定价与购买](https://www.coze.cn/open/docs/coze_pro)
目录
大纲
快速开始
本文介绍如何使用 Coze API Go SDK 完成扣子的常用操作，例如如何初始化 SDK、创建一个智能体草稿、发布智能体为 API 服务、和智能体对话等。​
准备工作​
初始化 SDK 前，请确认已完成以下操作：​
  * 已安装 Coze API Go SDK。详见​安装 Go SDK。​


  * 已实现授权流程，并通过环境变量方式配置了访问密钥。详细说明可参考​配置访问密钥。​


说明
请确保扣子 Go SDK 版本已升级至 v0.0.0-20250604025746-0d3b62f445d2 及之后版本，以免调用​发起对话或​执行对话流 API 失败。​
​
初始化 SDK​
初始化 Coze client 之后，才可以向扣子服务端发送 OpenAPI 请求。初始化时推荐通过环境变量动态获取访问密钥，以免硬编码引发数据安全风险。​
初始化代码如下：​
​
Go
复制
// This examples demonstrates how to initialize the Coze client with different configurations.​
func main() {​
// Get an access_token through personal access token or oauth.​
token := os.Getenv("COZE_API_TOKEN")​
authCli := coze.NewTokenAuth(token)​
​
// 1. Initialize with default configuration​
cozeCli1 := coze.NewCozeAPI(authCli)​
fmt.Println("client 1:", cozeCli1)​
​
// 2. Initialize with custom base URL​
cozeAPIBase := os.Getenv("COZE_API_BASE")​
cozeCli2 := coze.NewCozeAPI(authCli, coze.WithBaseURL(cozeAPIBase))​
fmt.Println("client 2:", cozeCli2)​
​
// 3. Initialize with custom HTTP client​
customClient := &http.Client{​
Timeout: 30 * time.Second,​
Transport: &http.Transport{​
MaxIdleConns: 100,​
MaxIdleConnsPerHost: 100,​
IdleConnTimeout: 90 * time.Second,​
},​
}​
cozeCli3 := coze.NewCozeAPI(authCli,​
coze.WithBaseURL(cozeAPIBase),​
coze.WithHttpClient(customClient),​
)​
fmt.Println("client 3:", cozeCli3)​
}​
​
创建并发布智能体为 API 服务​
通过 API 方式和智能体对话之前，你需要先创建一个智能体，并将其发布为 API 服务。你可以在扣子平台中创建智能体并发布，也可以通过调用相关的 API 实现。调用 API 创建智能体时，部分配置对应的 API 参数暂未开放，你只能为智能体添加知识库等有限的配置。创建智能体的操作步骤可参考​搭建一个低代码智能体。将智能体发布为 API 服务的操作步骤可参考​发布低代码智能体为 API 服务。​
  * 关于创建草稿智能体的完整示例代码，请参见 [GitHub 示例](https://github.com/coze-dev/coze-go/blob/main/examples/bots/publish/main.go)。​


  * 相关 API 接口描述，请参见：​


  * ​创建智能体。​


  * ​发布智能体。​


示例代码如下：​
​
Go
复制
// This examples is for describing how to create a bot, update a bot and publish a bot to the API.​
func main() {​
// Get an access_token through personal access token or oauth.​
token := os.Getenv("COZE_API_TOKEN")​
authCli := coze.NewTokenAuth(token)​
​
// Init the Coze client through the access_token.​
cozeCli := coze.NewCozeAPI(authCli, coze.WithBaseURL(os.Getenv("COZE_API_BASE")))​
​
// step one, create a bot​
workspaceID := os.Getenv("WORKSPACE_ID")​
​
// Call the upload file interface to get the avatar id.​
avatarPath := os.Getenv("IMAGE_FILE_PATH")​
ctx := context.Background()​
file, err := os.Open(avatarPath)​
if err != nil {​
fmt.Println("Error opening file:", err)​
return​
}​
uploadReq := &coze.UploadFilesReq{​
File: file,​
}​
avatarInfo, err := cozeCli.Files.Upload(ctx, uploadReq)​
if err != nil {​
fmt.Println("Error uploading avatar:", err)​
return​
}​
fmt.Println(avatarInfo)​
​
// build the request​
createResp, err := cozeCli.Bots.Create(ctx, &coze.CreateBotsReq{​
SpaceID: workspaceID,​
Description: "the description of your bot",​
Name: "the name of your bot",​
PromptInfo: &coze.BotPromptInfo{​
Prompt: "your prompt",​
},​
OnboardingInfo: &coze.BotOnboardingInfo{​
Prologue: "the prologue of your bot",​
SuggestedQuestions: []string{"question 1", "question 2"},​
},​
IconFileID: avatarInfo.FileInfo.ID,​
})​
if err != nil {​
fmt.Println("Error creating bot:", err)​
return​
}​
botID := createResp.BotID​
fmt.Println(createResp)​
fmt.Println(createResp.LogID())​
​
//​
// step two, update the bot, you can update the bot after being created​
// in this examples, we will update the avatar of the bot​
​
publishResp, err := cozeCli.Bots.Publish(ctx, &coze.PublishBotsReq{​
BotID: botID,​
ConnectorIDs: []string{"1024"},​
})​
if err != nil {​
fmt.Println("Error publishing bot:", err)​
return​
}​
fmt.Println(publishResp)​
fmt.Println(publishResp.LogID())​
​
//​
// step three, you can also modify the bot configuration and republish it.​
// in this examples, we will update the avatar of the bot​
​
newFile, err := os.Open(os.Getenv("IMAGE_FILE_PATH"))​
if err != nil {​
fmt.Println("Error opening file:", err)​
return​
}​
newUploadReq := &coze.UploadFilesReq{​
File: newFile,​
}​
newAvatarInfo, err := cozeCli.Files.Upload(ctx, newUploadReq)​
if err != nil {​
fmt.Println("Error uploading new avatar:", err)​
return​
}​
fmt.Println(newAvatarInfo)​
fmt.Println(newAvatarInfo.LogID())​
​
// Update bot​
updateResp, err := cozeCli.Bots.Update(ctx, &coze.UpdateBotsReq{​
BotID: botID,​
IconFileID: newAvatarInfo.FileInfo.ID,​
})​
if err != nil {​
fmt.Println("Error updating bot:", err)​
return​
}​
fmt.Println(updateResp.LogID())​
​
// Republish bot​
publishResp, err = cozeCli.Bots.Publish(ctx, &coze.PublishBotsReq{​
BotID: botID,​
ConnectorIDs: []string{"1024"},​
})​
if err != nil {​
fmt.Println("Error republishing bot:", err)​
return​
}​
fmt.Println(publishResp)​
fmt.Println(publishResp.LogID())​
}​
​
发起对话​
​发起对话接口用于向指定智能体发起一次对话，支持在对话时添加对话的上下文消息，以便智能体基于历史消息做出合理的回复。开发者可以按需选择响应方式，即流式或非流式响应，响应方式决定了开发者获取智能体回复的方式。​
  * 流式响应：智能体在生成回复的同时，将回复消息以数据流的形式逐条发送给客户端。处理结束后，服务端会返回拼接后完整的智能体回复。详细说明可参考​流式响应。 ​


  * 非流式响应：无论对话是否处理完毕，立即发送响应消息。开发者可以通过接口​查看对话详情。查看对话详情确认本次对话处理结束后，再调用​查看对话消息详情接口查看模型回复等完整响应内容。详细说明可参考​非流式响应。​


本文档以流式响应为例，演示通过 API 方式和智能体对话相关实例代码。你也可以查看 [Coze Go SDK 示例代码目录](https://github.com/coze-dev/coze-go/tree/main/examples/chats)，查看 chat 接口的其他实现方式，例如非流式响应、对话中发送多模态内容等。​
示例代码如下：​
​
Go
复制
package main​
​
import (​
"context"​
"errors"​
"fmt"​
"io"​
"os"​
"time"​
​
"github.com/coze-dev/coze-go"​
)​
​
func main() {​
ctx, cancel := context.WithTimeout(context.Background(), 10*time.Second)​
defer cancel()​
​
// Get an access_token through personal access token or oauth.​
token := os.Getenv("COZE_API_TOKEN")​
botID := os.Getenv("PUBLISHED_BOT_ID")​
userID := os.Getenv("USER_ID")​
​
authCli := coze.NewTokenAuth(token)​
​
// Init the Coze client through the access_token.​
cozeCli := coze.NewCozeAPI(authCli, coze.WithBaseURL(os.Getenv("COZE_API_BASE")))​
​
//​
// Step one, create chats​
// Call the coze.chats().stream() method to create a chats. The create method is a streaming​
// chats and will return a Flowable ChatEvent. Developers should iterate the iterator to get​
// chats event and handle them.​
// //​
req := &coze.CreateChatsReq{​
BotID: botID,​
UserID: userID,​
Messages: []*coze.Message{​
coze.BuildUserQuestionText("What can you do?", nil),​
},​
}​
​
resp, err := cozeCli.Chat.Stream(ctx, req)​
if err != nil {​
fmt.Printf("Error starting chats: %v\n", err)​
return​
}​
​
defer resp.Close()​
for {​
event, err := resp.Recv()​
if errors.Is(err, io.EOF) {​
fmt.Println("Stream finished")​
break​
}​
if err != nil {​
fmt.Println(err)​
break​
}​
if event.Event == coze.ChatEventConversationMessageDelta {​
fmt.Print(event.Message.Content)​
} else if event.Event == coze.ChatEventConversationChatCompleted {​
fmt.Printf("Token usage:%d\n", event.Chat.Usage.TokenCount)​
} else {​
fmt.Printf("\n")​
}​
}​
​
fmt.Printf("done, log:%s\n", resp.LogID())​
}​
​
上一篇
配置访问密钥
下一篇
安装并使用 Web SDK
准备工作
初始化 SDK
创建并发布智能体为 API 服务
发起对话
文档是否帮助到您？
有帮助无帮助
关闭
准备工作
初始化 SDK
创建并发布智能体为 API 服务
发起对话
![](https://bat.bing.com/action/0?ti=97151251&Ver=2&mid=2afb903e-482c-47fe-b946-74694d657895&bo=1&sid=a6c3ee30d4c211f0966da1ab2d8de18c&vid=a6c3dd00d4c211f0a7ba75271dd5e1e5&vids=0&msclkid=N&uach=pv%3D19.0.0&pi=0&lg=zh-CN&sw=1280&sh=720&sc=24&nwd=1&tl=%E6%89%A3%E5%AD%90%20-%20AI%20Agent%E6%99%BA%E8%83%BD%E5%8A%9E%E5%85%AC%E5%B9%B3%E5%8F%B0%20-%20%E6%89%A3%E5%AD%90%E7%94%A8AI%E9%87%8D%E5%A1%91%E7%94%9F%E4%BA%A7%E5%8A%9B%E4%B8%8E%E5%B7%A5%E4%BD%9C%E6%95%88%E7%8E%87&kw=%E6%89%A3%E5%AD%90,%20Coze,%20AI%20Agent,%20%E6%99%BA%E8%83%BD%E5%8A%9E%E5%85%AC,%20%E5%8A%9E%E5%85%AC%E6%8F%90%E6%95%88,%20AI%E5%86%99%E4%BD%9C,%20PPT%E7%94%9F%E6%88%90,%20%E7%BD%91%E9%A1%B5%E5%BC%80%E5%8F%91,%20%E7%94%9F%E4%BA%A7%E5%8A%9B%E5%B7%A5%E5%85%B7&p=https%3A%2F%2Fwww.coze.cn%2Fopen%2Fdocs%2Fdeveloper_guides%2Fgo_getting_started&r=&mtp=10&evt=pageLoad&sv=2&cdb=AQAQ&rn=29832)
![](https://bat.bing.com/action/0?ti=97179855&Ver=2&mid=8eb521ab-8977-4df5-b843-8e1028101068&bo=1&sid=a6c3ee30d4c211f0966da1ab2d8de18c&vid=a6c3dd00d4c211f0a7ba75271dd5e1e5&vids=0&msclkid=N&uach=pv%3D19.0.0&pi=0&lg=zh-CN&sw=1280&sh=720&sc=24&nwd=1&tl=%E6%89%A3%E5%AD%90%20-%20AI%20Agent%E6%99%BA%E8%83%BD%E5%8A%9E%E5%85%AC%E5%B9%B3%E5%8F%B0%20-%20%E6%89%A3%E5%AD%90%E7%94%A8AI%E9%87%8D%E5%A1%91%E7%94%9F%E4%BA%A7%E5%8A%9B%E4%B8%8E%E5%B7%A5%E4%BD%9C%E6%95%88%E7%8E%87&kw=%E6%89%A3%E5%AD%90,%20Coze,%20AI%20Agent,%20%E6%99%BA%E8%83%BD%E5%8A%9E%E5%85%AC,%20%E5%8A%9E%E5%85%AC%E6%8F%90%E6%95%88,%20AI%E5%86%99%E4%BD%9C,%20PPT%E7%94%9F%E6%88%90,%20%E7%BD%91%E9%A1%B5%E5%BC%80%E5%8F%91,%20%E7%94%9F%E4%BA%A7%E5%8A%9B%E5%B7%A5%E5%85%B7&p=https%3A%2F%2Fwww.coze.cn%2Fopen%2Fdocs%2Fdeveloper_guides%2Fgo_getting_started&r=&mtp=10&evt=pageLoad&sv=2&cdb=AQAQ&rn=834384)
rangeDom