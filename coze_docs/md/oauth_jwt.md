https://www.coze.cn/open/docs/developer_guides/oauth_jwt

# 扣子
创建
[主页](https://www.coze.cn/sign)[项目开发](https://www.coze.cn/sign)[资源库](https://www.coze.cn/sign)[任务中心](https://www.coze.cn/sign)[效果评测](https://www.coze.cn/sign)[空间配置](https://www.coze.cn/sign)
[模板商店](https://www.coze.cn/sign)[插件商店](https://www.coze.cn/sign)[作品社区](https://www.coze.cn/sign)[API 管理](https://www.coze.cn/open/playground)[文档中心](https://www.coze.cn/open/docs/guides)
目录取消固定
[使用指南](https://www.coze.cn/open/docs/guides)
[开发指南](https://www.coze.cn/open/docs/dev_how_to_guides)
[API 和 SDK](https://www.coze.cn/open/docs/developer_guides)
API 参考
[API 介绍](https://www.coze.cn/open/docs/developer_guides/coze_api_overview)[更新日志](https://www.coze.cn/open/docs/developer_guides/changelog)[准备工作](https://www.coze.cn/open/docs/developer_guides/preparation)[API Playground](https://www.coze.cn/open/docs/developer_guides/api_playground)
鉴权
[鉴权方式概述](https://www.coze.cn/open/docs/developer_guides/authentication)[添加个人访问令牌](https://www.coze.cn/open/docs/developer_guides/pat)[添加服务访问令牌](https://www.coze.cn/open/docs/developer_guides/service_token)[OAuth 应用管理](https://www.coze.cn/open/docs/developer_guides/oauth_apps)[通过示例文件体验 OAuth 授权流程](https://www.coze.cn/open/docs/developer_guides/ouath_demo)[OAuth 授权码授权](https://www.coze.cn/open/docs/developer_guides/oauth_code)[OAuth PKCE](https://www.coze.cn/open/docs/developer_guides/oauth_pkce)[OAuth 设备授权](https://www.coze.cn/open/docs/developer_guides/oauth_device_code)[OAuth JWT 授权（开发者）](https://www.coze.cn/open/docs/developer_guides/oauth_jwt)[OAuth JWT 授权（渠道场景）](https://www.coze.cn/open/docs/developer_guides/oauth_jwt_channel)[OAuth JWT 授权（跨账号授权场景）](https://www.coze.cn/open/docs/developer_guides/oauth_jwt_collaborate)[OAuth JWT 授权（企业特权应用）](https://www.coze.cn/open/docs/developer_guides/oauth_jwt_privilege)[OAuth 授权（多人协作场景）](https://www.coze.cn/open/docs/developer_guides/oauth_collaborate)[鉴权常见问题](https://www.coze.cn/open/docs/developer_guides/authentication_faq)
智能体和应用
[创建智能体](https://www.coze.cn/open/docs/developer_guides/create_bot)[更新智能体](https://www.coze.cn/open/docs/developer_guides/update_bot)[发布智能体](https://www.coze.cn/open/docs/developer_guides/publish_bot)[查看智能体列表](https://www.coze.cn/open/docs/developer_guides/bots_list_draft_published)[查看智能体配置](https://www.coze.cn/open/docs/developer_guides/get_metadata_draft_published)[开启或关闭智能体多人协作](https://www.coze.cn/open/docs/developer_guides/switch_bot_develop_mode)[添加智能体的协作者](https://www.coze.cn/open/docs/developer_guides/add_bot_collaborator)[添加应用的协作者](https://www.coze.cn/open/docs/developer_guides/add_app_collaborator)[删除智能体的协作者](https://www.coze.cn/open/docs/developer_guides/remove_bot_collaborator)[删除应用的协作者](https://www.coze.cn/open/docs/developer_guides/remove_app_collaborator)[查看智能体版本列表](https://www.coze.cn/open/docs/developer_guides/list_bot_versions)[复制资源](https://www.coze.cn/open/docs/developer_guides/copy_resource_task)[查询资源复制的结果](https://www.coze.cn/open/docs/developer_guides/query_resource_copy_execution_result)[下架智能体](https://www.coze.cn/open/docs/developer_guides/unpublish_agent)[Bot object](https://www.coze.cn/open/docs/developer_guides/bot_object)[查看应用列表](https://www.coze.cn/open/docs/developer_guides/published_apps_list)[智能体发布回调事件](https://www.coze.cn/open/docs/developer_guides/agent_callback_messages)[智能体删除回调事件](https://www.coze.cn/open/docs/developer_guides/agent_delete_callback_messages)[智能体下架回调事件](https://www.coze.cn/open/docs/developer_guides/agent_unpublished_callback_messages)
工作空间
[创建工作空间](https://www.coze.cn/open/docs/developer_guides/create_workspace)[查看空间列表](https://www.coze.cn/open/docs/developer_guides/list_workspace)[修改工作空间基本信息](https://www.coze.cn/open/docs/developer_guides/update_workspace_info)[查看空间成员列表](https://www.coze.cn/open/docs/developer_guides/list_space_member)[批量邀请用户加入空间](https://www.coze.cn/open/docs/developer_guides/add_space_member)[批量移除空间中的用户](https://www.coze.cn/open/docs/developer_guides/remove_space_member)
文件夹
[查询文件夹列表](https://www.coze.cn/open/docs/developer_guides/workspace_list_folder)[查询文件夹详情](https://www.coze.cn/open/docs/developer_guides/workspace_read_folder)
企业/组织
[成员管理（火山 API）](https://www.coze.cn/open/docs/developer_guides/create_coze_user)[添加团队/企业成员](https://www.coze.cn/open/docs/developer_guides/add_enterprise_member)[修改企业员工的角色](https://www.coze.cn/open/docs/developer_guides/update_enterprise_people)[移除团队/企业成员](https://www.coze.cn/open/docs/developer_guides/remove_enterprise_member)[创建组织](https://www.coze.cn/open/docs/developer_guides/create_organization)[修改组织基本信息](https://www.coze.cn/open/docs/developer_guides/update_organization_info)[查询组织列表](https://www.coze.cn/open/docs/developer_guides/list_organization)[添加组织成员](https://www.coze.cn/open/docs/developer_guides/add_organization_people)[查询组织成员列表](https://www.coze.cn/open/docs/developer_guides/list_organization_people)[修改组织成员角色](https://www.coze.cn/open/docs/developer_guides/update_organization_people)[移除组织成员](https://www.coze.cn/open/docs/developer_guides/remove_organization_member)
会话与消息
[创建会话](https://www.coze.cn/open/docs/developer_guides/create_conversation)[查看会话信息](https://www.coze.cn/open/docs/developer_guides/retrieve_conversation)[查看会话列表](https://www.coze.cn/open/docs/developer_guides/list_conversations)[更新会话名称](https://www.coze.cn/open/docs/developer_guides/edit_conversation)[删除会话](https://www.coze.cn/open/docs/developer_guides/delete_conversation)[清除上下文](https://www.coze.cn/open/docs/developer_guides/clear_conversation_context)[创建消息](https://www.coze.cn/open/docs/developer_guides/create_message)[查看消息列表](https://www.coze.cn/open/docs/developer_guides/list_message)[查看消息详情](https://www.coze.cn/open/docs/developer_guides/retrieve_message)[修改消息](https://www.coze.cn/open/docs/developer_guides/modify_message)[删除消息](https://www.coze.cn/open/docs/developer_guides/delete_message)[消息 type 说明](https://www.coze.cn/open/docs/developer_guides/message_type)[提交消息评价](https://www.coze.cn/open/docs/developer_guides/message_feedback)[删除消息评价](https://www.coze.cn/open/docs/developer_guides/delete_message_feedback)
对话
[发起对话](https://www.coze.cn/open/docs/developer_guides/chat_v3)[查看对话详情](https://www.coze.cn/open/docs/developer_guides/retrieve_chat)[查看对话消息详情](https://www.coze.cn/open/docs/developer_guides/list_chat_messages)[提交工具执行结果](https://www.coze.cn/open/docs/developer_guides/chat_submit_tool_outputs)[取消进行中的对话](https://www.coze.cn/open/docs/developer_guides/chat_cancel)
工作流
[执行工作流](https://www.coze.cn/open/docs/developer_guides/workflow_run)[执行工作流（流式响应）](https://www.coze.cn/open/docs/developer_guides/workflow_stream_run)[恢复运行工作流（流式响应）](https://www.coze.cn/open/docs/developer_guides/workflow_resume)[恢复运行工作流](https://www.coze.cn/open/docs/developer_guides/resume_workflow)[查询工作流异步运行结果](https://www.coze.cn/open/docs/developer_guides/workflow_history)[执行对话流](https://www.coze.cn/open/docs/developer_guides/workflow_chat)[查询输出节点的执行结果](https://www.coze.cn/open/docs/developer_guides/get_node_execute_history_response)[查询工作流列表](https://www.coze.cn/open/docs/developer_guides/get_workflow_list)[查询工作流基本信息](https://www.coze.cn/open/docs/developer_guides/get_workflow_info)[查询工作流的版本列表](https://www.coze.cn/open/docs/developer_guides/list_workflow_version)[开启或关闭工作流多人协作](https://www.coze.cn/open/docs/developer_guides/switch_workflow_develop_mode)[添加工作流协作者](https://www.coze.cn/open/docs/developer_guides/add_workflow_collaborator)[删除工作流协作者](https://www.coze.cn/open/docs/developer_guides/remove_workflow_collaborator)
文件
[上传文件](https://www.coze.cn/open/docs/developer_guides/upload_files)[查看文件详情](https://www.coze.cn/open/docs/developer_guides/retrieve_files)
智能音视频
ASR、TTS 与音色
[查看音色列表](https://www.coze.cn/open/docs/developer_guides/list_voices)[语音合成](https://www.coze.cn/open/docs/developer_guides/text_to_speech)[语音识别](https://www.coze.cn/open/docs/developer_guides/audio_transcriptions)[复刻音色](https://www.coze.cn/open/docs/developer_guides/clone_voices)
RTC 语音
[创建房间](https://www.coze.cn/open/docs/developer_guides/create_room)[Realtime 上行事件](https://www.coze.cn/open/docs/developer_guides/signaling_uplink_event)[Realtime 下行事件](https://www.coze.cn/open/docs/developer_guides/signaling_downlink_event)[Realtime 事件错误码](https://www.coze.cn/open/docs/developer_guides/realtime_error_codes)
WebSocket 语音
[双向流式语音识别](https://www.coze.cn/open/docs/developer_guides/asr_api)[双向流式语音识别事件](https://www.coze.cn/open/docs/developer_guides/asr_event)[双向流式语音合成](https://www.coze.cn/open/docs/developer_guides/tts_api)[双向流式语音合成事件](https://www.coze.cn/open/docs/developer_guides/tts_event)[双向流式语音对话](https://www.coze.cn/open/docs/developer_guides/streaming_chat_api)[双向流式对话上行事件](https://www.coze.cn/open/docs/developer_guides/streaming_chat_event)[双向流式对话下行事件](https://www.coze.cn/open/docs/developer_guides/streaming_chat_downlink_event)
声纹识别
[创建声纹组](https://www.coze.cn/open/docs/developer_guides/create_voiceprint_group)[查询声纹组列表](https://www.coze.cn/open/docs/developer_guides/list_voiceprint_group)[更新声纹组信息](https://www.coze.cn/open/docs/developer_guides/update_voiceprint_group)[删除声纹组](https://www.coze.cn/open/docs/developer_guides/delete_voiceprint_group)[创建声纹](https://www.coze.cn/open/docs/developer_guides/create_voiceprint)[更新声纹](https://www.coze.cn/open/docs/developer_guides/update_voiceprint)[查询声纹列表](https://www.coze.cn/open/docs/developer_guides/list_voiceprint)[删除声纹](https://www.coze.cn/open/docs/developer_guides/delete_voiceprint)[声纹特征比对](https://www.coze.cn/open/docs/developer_guides/identify_voiceprint)
知识库
[创建知识库](https://www.coze.cn/open/docs/developer_guides/create_dataset)[查看知识库列表](https://www.coze.cn/open/docs/developer_guides/list_dataset)[修改知识库信息](https://www.coze.cn/open/docs/developer_guides/update_dataset)[删除知识库](https://www.coze.cn/open/docs/developer_guides/delete_dataset)[创建知识库文件](https://www.coze.cn/open/docs/developer_guides/create_knowledge_files)[修改知识库文件](https://www.coze.cn/open/docs/developer_guides/modify_knowledge_files)[查看知识库文件列表](https://www.coze.cn/open/docs/developer_guides/list_knowledge_files)[查看知识库文件上传进度](https://www.coze.cn/open/docs/developer_guides/get_dataset_progress)[更新知识库图片描述](https://www.coze.cn/open/docs/developer_guides/update_image_caption)[查看知识库图片列表](https://www.coze.cn/open/docs/developer_guides/get_images)[删除知识库文件](https://www.coze.cn/open/docs/developer_guides/delete_knowdge_files)
插件
[查询付费插件列表](https://www.coze.cn/open/docs/developer_guides/list_plugin)[查询插件分类](https://www.coze.cn/open/docs/developer_guides/list_plugin_category)[查询插件详情](https://www.coze.cn/open/docs/developer_guides/get_plugin)[批量查询插件信息](https://www.coze.cn/open/docs/developer_guides/batch_get_plugins_info)[调用插件工具](https://www.coze.cn/open/docs/developer_guides/call_plugin_tool)[申请插件扩容回调事件](https://www.coze.cn/open/docs/developer_guides/benefit_plugin_scale_requested)[插件扩容到期回调事件](https://www.coze.cn/open/docs/developer_guides/benefit_plugin_scale_expired)
变量
[设置用户变量的值](https://www.coze.cn/open/docs/developer_guides/update_variable)[获取用户变量的值](https://www.coze.cn/open/docs/developer_guides/read_variable)
渠道
[更新审核结果](https://www.coze.cn/open/docs/developer_guides/update_review_result)[添加发布平台](https://www.coze.cn/open/docs/developer_guides/install_channel)[绑定设备](https://www.coze.cn/open/docs/developer_guides/bind_connector_config)
终端用户配额管控
[创建终端用户权益额度](https://www.coze.cn/open/docs/developer_guides/create_device_quotas)[查询终端用户的权益配额](https://www.coze.cn/open/docs/developer_guides/get_device_quotas)[更新终端用户的权益额度](https://www.coze.cn/open/docs/developer_guides/update_device_quotas)
账单与权益
[导出终端用户账单](https://www.coze.cn/open/docs/developer_guides/create_bill_task)[查询账单文件](https://www.coze.cn/open/docs/developer_guides/billing_file)[查询套餐权益](https://www.coze.cn/open/docs/developer_guides/get_benefit)[账单推送回调事件](https://www.coze.cn/open/docs/developer_guides/billing_callback_message)
回调
[创建回调应用](https://www.coze.cn/open/docs/developer_guides/create_callback_app)[修改回调应用](https://www.coze.cn/open/docs/developer_guides/update_callback_app)[查询回调应用列表](https://www.coze.cn/open/docs/developer_guides/list_callback_app)[删除回调应用](https://www.coze.cn/open/docs/developer_guides/delete_callback_app)[订阅回调事件](https://www.coze.cn/open/docs/developer_guides/subscribe_callback_message)[查询已订阅的事件](https://www.coze.cn/open/docs/developer_guides/list_subscribed_callback_message)[取消订阅事件](https://www.coze.cn/open/docs/developer_guides/unsubscribe_callback_message)
历史版本接口
[【Deprecated】查看已发布智能体列表](https://www.coze.cn/open/docs/developer_guides/published_bots_list)[【Deprecated】获取已发布智能体的配置](https://www.coze.cn/open/docs/developer_guides/get_metadata)
[错误码](https://www.coze.cn/open/docs/developer_guides/coze_error_codes)[API 常见问题](https://www.coze.cn/open/docs/developer_guides/api_faq)[模型能力差异](https://www.coze.cn/open/docs/developer_guides/model_api_param_support)
最佳实践
[通过对话接口获取智能体回复](https://www.coze.cn/open/docs/developer_guides/get_chat_response)[错误码 4100/4101 问题排查](https://www.coze.cn/open/docs/developer_guides/troubleshooting_4100_4101)[如何实现会话隔离](https://www.coze.cn/open/docs/developer_guides/session_isolation)[升级企业/团队版后更新 API 授权](https://www.coze.cn/open/docs/developer_guides/update_authorization)
SDK 参考
Chat SDK
[Chat SDK 概述](https://www.coze.cn/open/docs/developer_guides/web_sdk_overview)[安装并使用 Chat SDK](https://www.coze.cn/open/docs/developer_guides/install_web_sdk)[Chat SDK 发布历史](https://www.coze.cn/open/docs/developer_guides/web_sdk_changelog)[（历史版本）Chat SDK](https://www.coze.cn/open/docs/developer_guides/web_sdk)[Chat SDK 常见问题](https://www.coze.cn/open/docs/developer_guides/chat_sdk_faq)
Python SDK
[Python SDK 概述](https://www.coze.cn/open/docs/developer_guides/python_overview)[安装 Python SDK](https://www.coze.cn/open/docs/developer_guides/python_installation)[配置访问密钥](https://www.coze.cn/open/docs/developer_guides/python_access_token)[快速开始](https://www.coze.cn/open/docs/developer_guides/python_getting_started)
Node.js SDK
[Node.js SDK 概述](https://www.coze.cn/open/docs/developer_guides/nodejs_overview)[安装 Node.js SDK](https://www.coze.cn/open/docs/developer_guides/nodejs_install)[配置访问密钥](https://www.coze.cn/open/docs/developer_guides/nodejs_access_token)[快速开始](https://www.coze.cn/open/docs/developer_guides/nodejs_getting_started)
Java SDK
[Java SDK 概述](https://www.coze.cn/open/docs/developer_guides/java_overview)[安装 Java SDK](https://www.coze.cn/open/docs/developer_guides/java_installation)[配置访问密钥](https://www.coze.cn/open/docs/developer_guides/java_access_token)[快速开始](https://www.coze.cn/open/docs/developer_guides/java_getting_started)
Go SDK
[Go SDK 概述](https://www.coze.cn/open/docs/developer_guides/go_overview)[安装 Go SDK](https://www.coze.cn/open/docs/developer_guides/go_installation)[配置访问密钥](https://www.coze.cn/open/docs/developer_guides/go_access_token)[快速开始](https://www.coze.cn/open/docs/developer_guides/go_getting_started)
Web SDK
[安装并使用 Web SDK](https://www.coze.cn/open/docs/developer_guides/ui_builder_web_sdk)
Card SDK
[安装并使用 Card SDK](https://www.coze.cn/open/docs/developer_guides/card_sdk)
[实践教程](https://www.coze.cn/open/docs/tutorial)
[扣子空间](https://www.coze.cn/open/docs/cozespace)
[扣子罗盘](https://www.coze.cn/open/docs/cozeloop)
[客户案例](https://www.coze.cn/open/docs/customers)
[定价与购买](https://www.coze.cn/open/docs/coze_pro)
目录
大纲
OAuth JWT 授权（开发者）
纯后端应用通常不包含任何用户界面元素，用户无法直接与之交互。该场景下建议使用 JWT（JSON Web Token）模式，扣子账号直接永久授予 OAuth App 权限，OAuth App 随时可以通过后端应用签发的 JWT 获取访问令牌，以后端应用的身份请求扣子 API。​
说明
OAuth 授权码授权、PKCE 授权、设备授权模式下，扣子支持多人协作场景下跨账号的 OAuth 授权，详细说明可参考​OAuth 授权（多人协作场景）。​
​
示例项目源码​
使用 JWT 进行鉴权的步骤较为复杂，扣子提供了 Python 等多语言 SDK，能够有效简化鉴权流程，支持扣子的各种鉴权模式。推荐使用扣子 SDK 实现鉴权。以下是基于扣子 SDK 的 OAuth JWT 授权的示例代码，供参考：​
​
Python ​|  Node.js​|  Java ​|  Go​  
---|---|---|---  
[examples/](https://github.com/coze-dev/coze-py/blob/main/examples/auth_oauth_jwt.py)[auth_oauth_jwt.py](https://github.com/coze-dev/coze-py/blob/main/examples/auth_oauth_jwt.py)​| [auth/auth-oauth-jwt.ts](https://github.com/coze-dev/coze-js/blob/main/examples/coze-js-node/src/auth/auth-oauth-jwt.ts)​[auth/auth-oauth-jwt-channel.ts](https://github.com/coze-dev/coze-js/blob/main/examples/coze-js-node/src/auth/auth-oauth-jwt-channel.ts)​| [JWTOauthExample.java](https://github.com/coze-dev/coze-java/blob/main/example/src/main/java/example/auth/JWTOAuthExample.java)​| [jwt_example.go](https://github.com/coze-dev/coze-go/blob/main/examples/auth/jwt_oauth/main.go)​  
​
授权流程​
授权流程如下：​
1.
在扣子平台创建 OAuth 应用并完成授权。​


2.
应用程序通过公钥和私钥签署 JWT。​


3.
应用程序通过 API，获取访问令牌，具体请参见​通过 JWT 获取 Oauth Access Token 。​


4.
应用程序根据访问令牌调用扣子 API。​


详细步骤如下：​
1 创建 Oauth 应用并授权​
你需要在扣子平台中创建 OAuth 应用。 ​
说明
  * 在扣子团队版或扣子企业版中，仅组织超级管理员和管理员有权限创建、编辑、删除 OAuth 应用，以及对应用进行授权操作。​


  * 扣子企业版多组织场景中，创建的 OAuth 应用默认只有本组织资源的访问权限。如果要访问其他组织的资源，可以将 OAuth 应用的授权链接分享给目标组织的超级管理员或管理员，对方确认授权后才能访问，具体操作请参见​2 分享授权链接并授权。​


​
1.
登录扣子平台。 ​


2.
在左侧导航栏选择 API 管理。​


3.
在顶部单击授权 > [OAuth 应用](https://www.coze.cn/open/oauth/apps)页签。​


4.
在 OAuth 应用页面右上角单击创建新应用，填写应用的基本信息，并单击创建并继续。​


  * ​
配置​| 说明​  
---|---  
应用类型 ​| 应用的类型，此处应指定为普通。​  
客户端类型​| 客户端类型，此处设置为服务类应用。​  
应用名称 ​| 应用的名称，在扣子平台中全局唯一。 ​  
描述 ​| 应用的基本描述信息。 ​  
​


5.
填写应用的配置信息。 ​


  * ​
​​![](data:image/svg+xml,%3csvg%20xmlns=%27http://www.w3.org/2000/svg%27%20version=%271.1%27%20width=%27500%27%20height=%27527.2835112692765%27/%3e)![](data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNTAwIiBoZWlnaHQ9IjUyNy4yODM1MTEyNjkyNzY1IiB2ZXJzaW9uPSIxLjEiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+PC9zdmc+)​
​


  * ​
配置​| 说明​  
---|---  
公钥和私钥 ​| 用于应用程序客户端身份认证的非对称密钥。 ​单击创建 Key，页面将自动创建一对公钥和私钥，公钥自动配置在扣子中，私钥以 private_key.pem 文件格式由网页自动下载至本地 Downloads 目录下。支持创建最多三对公钥和私钥。​说明
    * 建议将 private_key.pem 文件安全地存储在只有您的应用可以访问的位置。​
    * 扣子使用符合行业标准的 WebCrypto 加密标准，在浏览器前端创建非对称密钥，密钥强度符合行业标准。扣子任何时候都不会上传私钥到后端。请您放心使用。​
​  
权限 ​| 应用程序调用扣子 API 时需要的权限范围。不同层级权限的生效范围请参见​权限层级。​说明此处配置旨在于划定应用的权限范围，并未完成授权操作。创建 OAuth 应用后还需要参考后续操作完成授权。​​  
​


6.
单击确定，完成配置。 ​


7.
在弹出的对话框中，确认权限等信息无误后，单击授权。​


  * ​
​​![](data:image/svg+xml,%3csvg%20xmlns=%27http://www.w3.org/2000/svg%27%20version=%271.1%27%20width=%27300%27%20height=%27410.74523396880414%27/%3e)![](data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMzAwIiBoZWlnaHQ9IjQxMC43NDUyMzM5Njg4MDQxNCIgdmVyc2lvbj0iMS4xIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciPjwvc3ZnPg==)​
​


2 签署 JWT​
扣子的 JWT 生成方式及部分参数定义沿用业界统一流程规范，但 JWT 中 Header 和 Payload 部分由扣子平台自行定义。​
在 [JWT](https://jwt.io/)（JSON Web Tokens）的流程中，通常使用私钥来签署（sign）token。JWT 包含三部分，即 Header、Payload 和 signature，其中 header 和 payload 由参数拼接而成，signature 根据指定的签名算法和私钥对 Header 和 Payload 自动计算生成。三部分之间用点（.）分隔。详细的签署方式可参考[JWT 官方文档](https://jwt.io/)。​
Header 和 Payload​
扣子平台对 Header 和 Payload 的定义如下：​
  * Header​


  * Header 部分的参数定义如下：​


  * ​
参数​| 类型​| 是否必选​| 说明​  
---|---|---|---  
alg​| String​| 必选​| 签名使用的加密算法，固定为 RS256。​RS256 是一种基于非对称加密的签名算法，它结合了 RSA 加密和 SHA-256 哈希算法。​  
typ​| String​| 必选​| 固定为 JWT。​  
kid​| String​| 必选​| OAuth 应用的公钥指纹，可以在[OAuth 应用](https://www.coze.cn/open/oauth/apps)页面找到这个应用，在操作列单击编辑图标，进入配置页面查看公钥指纹。​​​​![](data:image/svg+xml,%3csvg%20xmlns=%27http://www.w3.org/2000/svg%27%20version=%271.1%27%20width=%27400%27%20height=%27308.83720930232556%27/%3e)![](data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNDAwIiBoZWlnaHQ9IjMwOC44MzcyMDkzMDIzMjU1NiIgdmVyc2lvbj0iMS4xIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciPjwvc3ZnPg==)​​  
​


  * Header 示例如下：​


  * ​
JSON
复制
{​
"alg": "RS256", // 固定为RS256​
"typ": "JWT", // 固定为 JWT​
"kid": "gdehvaDegW....." // OAuth 应用的公钥指纹​
}​
​


  * Payload：​


  * Payload 部分的参数定义如下：​


  * ​
参数​| 类型​| 是否必选​| 说明​  
---|---|---|---  
iss​| String​| 必选​| OAuth 应用的 ID，可以在[OAuth 应用](https://www.coze.cn/open/oauth/apps)页面查看。​  
aud​| String​| 必选​| 扣子 API 的 Endpoint，即 api.coze.cn。​  
iat​| Integer​| 必选​| JWT 开始生效的时间，Unixtime 时间戳格式，精确到秒。一般为当前时刻。​  
exp​| Integer​| 必选​| JWT 过期的时间，Unixtime 时间戳格式，精确到秒。必须晚于 iat。​  
jti​| String​| 必选​| 随机字符串，用于防止重放攻击。建议长度大于 32 字节。每次签署 JWT 时应指定为不同的字符串。​  
session_name​| String​| 可选​| 访问令牌的会话标识。目前仅限在会话隔离场景下使用，即将 session_name 指定为用户在业务侧的 UID，以此区分不同业务侧用户的对话历史。​若未指定 session_name，不同用户的对话历史可能会掺杂在一起。​说明会话隔离的详细实现方法请参见​如何实现会话隔离。​​  
session_context​| Object​| 可选 ​| 会话上下文信息，包含设备相关信息等。​​  
session_context.device_info​| Object​| 可选 ​| 用于配置设备相关信息，扣子平台基于该部分信息对设备做用量管控以及账单记录。​说明仅扣子企业版支持该参数。硬件设备用量管控的具体操作可参考​终端用户用量查询和配额管控。​  
session_context.device_info.device_id​| String​| 可选 ​| IoT 等硬件设备 ID，一个设备对应一个唯一的设备号。​当需要记录设备用量或对设备用量进行管控时，需要填写该参数，否则，无法对设备进行用量管控，用量统计页面对应的设备 ID 将显示为 N/A。​  
session_context.device_info.custom_consumer​​| String​| 可选 ​| 自定义维度的实体 ID，你可以根据业务需要进行设置，例如 APP 上的用户名等。​当需要记录设备用量或对设备用量进行管控，需要填写该参数，否则，无法对设备进行用量管控，用量统计页面对应的自定义 ID 将显示为 N/A。​说明
    * device_id 和 custom_consumer 建议选择其中一个即可。​
    * custom_consumer 参数用于设备用量管控，与对话等 API 传入的 user_id 无关，user_id 主要用于上下文、数据库隔离等场景。​
    * 出于数据隐私及信息安全等方面的考虑，不建议使用业务系统中定义的用户敏感标识（如手机号等）作为 custom_consumer 的值。​
​  
​


  * Payload 示例如下：​


  * ​
JSON
复制
{​
"iss": "310000000002", // OAuth 应用的 ID​
"aud": "api.coze.cn", // 扣子 API 的 Endpoint​
"iat": 1516239022, // JWT 开始生效的时间，秒级时间戳​
"exp": 1516259022, // JWT 过期时间，秒级时间戳​
"jti": "fhjashjgkhalskj", // 随机字符串，防止重放攻击​
"session_name": "user_2222", //用户在业务侧的 UID​
"session_context": {​
"device_info": {​
"device_id": "1234567890" // IoT 等硬件设备的唯一标识 ID​
}​
}​
}​
​


示例代码​
你可以直接参考以下示例代码签署 JWT。​
​
Python
复制
# You must run `pip install PyJWT cryptography` to install the PyJWT and the cryptography packages in order to use this script.​
​
#!/usr/bin/env python3​
import sys​
import time​
import uuid​
​
import jwt​
​
# 替换为你的实际 Coze App 私钥​
signing_key = '''​
\-----BEGIN PRIVATE KEY-----​
xxxxxxxxxxxxxxxxxx​
\-----END PRIVATE KEY-----​
'''​
​
payload = {​
'iat': int(time.time()),​
'exp': int(time.time()) + 600,​
"jti": str(uuid.uuid4()),​
'aud': 'api.coze.cn', # 替换为实际的coze api domain​
'iss': '1127900106117' # 替换为你的实际 Coze App ID​
}​
​
headers = {​
'kid': '_v0VjcMlLdQc3tRTD3jC5Xz29TUnKQOhtuD5k-gpyf4' # 替换为你的实际 Coze App 公钥指纹​
}​
​
# Create JWT with headers​
encoded_jwt = jwt.encode(payload, signing_key, algorithm='RS256', headers=headers)​
​
print(f"JWT: {encoded_jwt}")​
​
最终生成的 JWT 示例如下：​
​
Plain Text
复制
eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCIsImtpZCI6InZZd2ZsdFR1OWZBbWtwWFhSdnR5UmREc3RONVMzZWNFcDFqVzB6dVQyRE****.eyJpc3MiOiIzMTAwMDAwMDAwMDIiLCJhdWQiOiJhcGkuY296ZS5jb20iLCJpYXQiOjE1MTYyMzkwMjIsImV4cCI6MTkxNjI1OTAyMiwianRpIjoiZmhqaGFsc2tqZmFkc2pld3F****.CuoiCCF-nHFyGmu2EKlwFoyd3uDyKQ3Drc1CrXQyMVySTzZlZd2M7zKWsziB3AktwbUZiRJlQ1HbghR05CW2YRHwKL4-dlJ4koR3onU7iQAO5DkPCaIxbAuTsQobtCAdkkZTg8gav9EnN1QN_1xq0w8BzuuhS7wCeY8UbaskkTK9GnO4eU9tEINmVw-2CrfB-kNbEHlEDwXfcrb4YPpkw3GhmuPShenNLObfSWS0CqIyakXL8qD5AgXLoB-SejAsRdzloSUInNXENJHfSVMkThxRhJy7yEjX3BmculC54fMKENRfLElBqwJyLLUjeRHsYnaru2ca4W8_yaPJ7F****​
​
3 获取访问令牌​
应用程序调用 ​通过 JWT 获取 Oauth Access Token API ，请求 Header 中携带 JWT，扣子服务端会在响应中通过 access_token 字段返回访问令牌。​
请求示例如下：​
扣子个人版和团队版
扣子企业版多组织
​
Shell
复制
curl --location --request POST 'https://api.coze.cn/api/permission/oauth2/token' \​
\--header 'Content-Type: application/json' \​
\--header 'Authorization: Bearer eyJhbGciOiJSUzI1NiIyRE****.eyJpc3MiOiIzMTAwMDAwMDAwMDIiLCJhdWQiOiJhcGkuY296ZS5jb20iLCJpYXQiOjE1MTYyMzkwMjIsImV4cCI6MTkxNjI1OTAyMiwianRpIjoiZmhqaGFsc2tqZmFkc2pld3F****.CuoiCCF-nHFyGmu2EKlwFoyd3uDyKQ3Drc1CrXQyMVySTzZlZd2M7zKWsziB3AktwbUZiRJlQ1HbghR05CW2YRHwKL4-dlJ4koR3onU7iQAO5DkPCaIxbAuXfcrb4YPpkw3GhmuPShenNLObfSWS0CqIyakXL8qD5AgXLoB-SejAsRdzloSUInNXENJHfSVMkThxRhJy7yEjX3BmculC54fMKENRfLElBqwJyLLUjeRHsYnaru2ca4W8_yaPJ7F****' \​
\--data '{​
"duration_seconds": 86399,​
"grant_type": "urn:ietf:params:oauth:grant-type:jwt-bearer"​
}'​
​
​
返回示例如下：​
​
JSON
复制
{​
"access_token": "czs_RQOhsc7vmUzK4bNgb7hn4wqOgRBYAO6xvpFHNbnl6RiQJX3cSXSguIhFDzgy****",​
"expires_in": 1721135859​
}​
​
4 发起扣子 API 请求​
在 API 请求头中通过 Authorization=Bearer $Access_Token指定访问令牌，发起扣子 API 请求。每个接口对应的权限点不同。​
以​查看智能体配置 API 为例，完整的 API 请求如下：​
​
Shell
复制
curl --location --request GET 'https://api.coze.cn/v1/bots/73428668*****?is_published=true' \ ​
\--header 'Authorization: Bearer czu_UEE2mJn66h0fMHxLCVv9uQ7HAoNNS8DmF6N6grjWmkHX2jPm8SR0tJcKop8v****' \​
​
通过 JWT 获取 Oauth Access Token​
通过 JWT 获取 Oauth Access Token。​
说明
  * JWT 仅能使用一次，如需再次申请 OAuth Access Token，必须重新生成一个 JWT。​


  * OAuth Access Token 的有效期默认为 15 分钟，不支持刷新。如需获取新的 Access Token，你需要再次生成一个 JWT，并调用此接口。​


​
基础信息​
​
请求方式​| POST​  
---|---  
请求地址​| 
  * 扣子个人版和团队版：https://api.coze.cn/api/permission/oauth2/token​


  * 扣子企业版多组织：https://api.coze.cn/api/permission/oauth2/account/{account_id}/token​

  
​
请求参数​
Header​
​
参数​| 取值​| 说明​  
---|---|---  
Content-Type ​| application/json​| 请求正文的方式。​  
Authorization​| Bearer $JWT​| 使用应用的客户端私钥签署的 JWT。生成方式可参考​2 签署 JWT。​  
​
Path​
​
参数​| 类型​| 是否必选​| 说明​  
---|---|---|---  
account_id​| String​| 可选​| 在扣子企业版中，如果需要在指定组织下获取 Token，需要在 Path 中填写组织 ID。组织 ID 的获取方式如下：​组织超级管理员或管理员可以在组织设置页面查看对应的组织 ID。​​​​![](data:image/svg+xml,%3csvg%20xmlns=%27http://www.w3.org/2000/svg%27%20version=%271.1%27%20width=%27500%27%20height=%27383.89121338912133%27/%3e)![](data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNTAwIiBoZWlnaHQ9IjM4My44OTEyMTMzODkxMjEzMyIgdmVyc2lvbj0iMS4xIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciPjwvc3ZnPg==)​​  
​
Body​
​
参数​| 类型​| 是否必选​| 说明​  
---|---|---|---  
grant_type​| String​| 必选​| 固定为 urn:ietf:params:oauth:grant-type:jwt-bearer。​  
duration_seconds​| Integer​| 可选​| 申请的 AccessToken 有效期，单位为秒，默认 900 秒，即 15 分钟。最大可设置为 86399 秒，即 24 小时。​  
​
返回参数​
​
参数​| 类型​| 说明​  
---|---|---  
access_token​| String​| OAuth Access Token。​  
expires_in​| Integer​| OAuth Access Token 的过期时间，Unixtime 时间戳格式，单位为秒。​  
​
示例 ​
请求示例 ​
​
Shell
复制
curl --location 'https://api.coze.cn/api/permission/oauth2/token' \​
\--header 'Content-Type: application/json' \​
\--header 'Authorization: Bearer eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCIsImtpZCI6InZZd2ZsdFR1OWZBbWtwWFhSdnR5UmREc3RONVMzZWNFcDFqVzB6dVQyRE****.eyJpc3MiOiIzMTAwMDAwMDAwMDIiLCJhdWQiOiJhcGkuY296ZS5jb20iLCJpYXQiOjE1MTYyMzkwMjIsImV4cCI6MTkxNjI1OTAyMiwianRpIjoiZmhqaGFsc2tqZmFkc2pld3F****.CuoiCCF-nHFyGmu2EKlwFoyd3uDyKQ3Drc1CrXQyMVySTzZlZd2M7zKWsziB3AktwbUZiRJlQ1HbghR05CW2YRHwKL4-dlJ4koR3onU7iQAO5DkPCaIxbAuTsQobtCAdkkZTg8gav9EnN1QN_1xq0w8BzuuhS7wCeY8UbaskkTK9GnO4eU9tEINmVw-2CrfB-kNbEHlEDwXfcrb4YPpkw3GhmuPShenNLObfSWS0CqIyakXL8qD5AgXLoB-SejAsRdzloSUInNXENJHfSVMkThxRhJy7yEjX3BmculC54fMKENRfLElBqwJyLLUjeRHsYnaru2ca4W8_yaPJ7F****' \​
\--data '{​
"duration_seconds": 86399,​
"grant_type": "urn:ietf:params:oauth:grant-type:jwt-bearer"​
}'​
​
返回示例​
​
JSON
复制
{​
"access_token": "czs_RQOhsc7vmUzK4bNgb7hn4wqOgRBYAO6xvpFHNbnl6RiQJX3cSXSguIhFDzgy****",​
"expires_in": 1721135859​
}​
​
错误码​
​
error_code​| error_message​| 说明​  
---|---|---  
invalid_request​| invalid request: {parameter}​​| 
  * 原因：请求参数 {parameter} 错误。​


  * 解决方案：请参考 API 文档查看参数说明。​

  
invalid_client​| /​| 
  * 原因：客户端凭证（JWT Token 或者 Client Secret）无效。​


  * 解决方案：请校验您的客户端凭证。​

  
unsupported_grant_type​| not supported grant type: {grant type}​| 
  * 原因：不支持的授权类型 {grant type}。​


  * 解决方案：请参考 API 文档指定正确的授权类型。​

  
access_deny​| app: {app name} is currently deactivated by the owner​| 
  * 原因：OAuth 应用已被禁用。​


  * 解决方案：在扣子平台中启用 OAuth 应用。​

  
​| invalid app type​| 
  * 原因：应用类型错误。​


  * 解决方案：渠道应用暂不支持授权码模式。​

  
​| login session invalid​| 
  * 原因：登录态无效。​


  * 解决方案：用户需要重新登陆扣子平台。​

  
internal_error​| Service internal error.​| 
  * 原因：服务内部错误。​


  * 解决方案：建议稍后重试。​

  
​
​
​
上一篇
OAuth 设备授权
下一篇
OAuth JWT 授权（渠道场景）
示例项目源码
授权流程
1 创建 Oauth 应用并授权
2 签署 JWT
Header 和 Payload
示例代码
3 获取访问令牌
4 发起扣子 API 请求
通过 JWT 获取 Oauth Access Token
基础信息
请求参数
Header
Path
Body
返回参数
示例 
请求示例 
返回示例
错误码
文档是否帮助到您？
有帮助无帮助
关闭
示例项目源码
授权流程
1 创建 Oauth 应用并授权
2 签署 JWT
Header 和 Payload
示例代码
3 获取访问令牌
4 发起扣子 API 请求
通过 JWT 获取 Oauth Access Token
基础信息
请求参数
Header
Path
Body
返回参数
示例 
请求示例 
返回示例
错误码
![](https://bat.bing.com/action/0?ti=97151251&Ver=2&mid=19951a29-2ab2-4da3-bf78-2a1c2dedf303&bo=1&sid=a6c3ee30d4c211f0966da1ab2d8de18c&vid=a6c3dd00d4c211f0a7ba75271dd5e1e5&vids=0&msclkid=N&uach=pv%3D19.0.0&pi=0&lg=zh-CN&sw=1280&sh=720&sc=24&nwd=1&tl=%E6%89%A3%E5%AD%90%20-%20AI%20Agent%E6%99%BA%E8%83%BD%E5%8A%9E%E5%85%AC%E5%B9%B3%E5%8F%B0%20-%20%E6%89%A3%E5%AD%90%E7%94%A8AI%E9%87%8D%E5%A1%91%E7%94%9F%E4%BA%A7%E5%8A%9B%E4%B8%8E%E5%B7%A5%E4%BD%9C%E6%95%88%E7%8E%87&kw=%E6%89%A3%E5%AD%90,%20Coze,%20AI%20Agent,%20%E6%99%BA%E8%83%BD%E5%8A%9E%E5%85%AC,%20%E5%8A%9E%E5%85%AC%E6%8F%90%E6%95%88,%20AI%E5%86%99%E4%BD%9C,%20PPT%E7%94%9F%E6%88%90,%20%E7%BD%91%E9%A1%B5%E5%BC%80%E5%8F%91,%20%E7%94%9F%E4%BA%A7%E5%8A%9B%E5%B7%A5%E5%85%B7&p=https%3A%2F%2Fwww.coze.cn%2Fopen%2Fdocs%2Fdeveloper_guides%2Foauth_jwt&r=&mtp=10&evt=pageLoad&sv=2&cdb=AQAQ&rn=253075)
![](https://bat.bing.com/action/0?ti=97179855&Ver=2&mid=310877fe-8730-4830-b43d-1a9d93624f48&bo=1&sid=a6c3ee30d4c211f0966da1ab2d8de18c&vid=a6c3dd00d4c211f0a7ba75271dd5e1e5&vids=0&msclkid=N&uach=pv%3D19.0.0&pi=0&lg=zh-CN&sw=1280&sh=720&sc=24&nwd=1&tl=%E6%89%A3%E5%AD%90%20-%20AI%20Agent%E6%99%BA%E8%83%BD%E5%8A%9E%E5%85%AC%E5%B9%B3%E5%8F%B0%20-%20%E6%89%A3%E5%AD%90%E7%94%A8AI%E9%87%8D%E5%A1%91%E7%94%9F%E4%BA%A7%E5%8A%9B%E4%B8%8E%E5%B7%A5%E4%BD%9C%E6%95%88%E7%8E%87&kw=%E6%89%A3%E5%AD%90,%20Coze,%20AI%20Agent,%20%E6%99%BA%E8%83%BD%E5%8A%9E%E5%85%AC,%20%E5%8A%9E%E5%85%AC%E6%8F%90%E6%95%88,%20AI%E5%86%99%E4%BD%9C,%20PPT%E7%94%9F%E6%88%90,%20%E7%BD%91%E9%A1%B5%E5%BC%80%E5%8F%91,%20%E7%94%9F%E4%BA%A7%E5%8A%9B%E5%B7%A5%E5%85%B7&p=https%3A%2F%2Fwww.coze.cn%2Fopen%2Fdocs%2Fdeveloper_guides%2Foauth_jwt&r=&mtp=10&evt=pageLoad&sv=2&cdb=AQAQ&rn=843428)
rangeDom